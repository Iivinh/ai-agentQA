CREATE TABLE FACULTY
(
	ID_FACULTY VARCHAR (1) NOT NULL,
	NAME NVARCHAR (100) NOT NULL,
	PRIMARY KEY (ID_FACULTY)
)

CREATE TABLE MAJOR
(
	ID_MAJOR VARCHAR (10) NOT NULL,
	NAME NVARCHAR (100) NOT NULL,
	ID_FACULTY VARCHAR (1) NOT NULL,
	PRIMARY KEY (ID_MAJOR),
	FOREIGN KEY (ID_FACULTY) REFERENCES FACULTY(ID_FACULTY)
)

CREATE TABLE PROGRAM
(
	ID_PROGRAM VARCHAR (8) NOT NULL,
	ADMISSION_YEAR INT NOT NULL,
	TOTAL_CREDIT INT NOT NULL,
	TOTAL_SEMESTER INT NOT NULL,
	ID_MAJOR VARCHAR (10) NOT NULL,
	PRIMARY KEY (ID_PROGRAM, ADMISSION_YEAR),
	FOREIGN KEY (ID_MAJOR) REFERENCES MAJOR (ID_MAJOR)
)

CREATE TABLE CLASS
(
	ID_CLASS VARCHAR (8) NOT NULL,
	ID_MAJOR VARCHAR (10) NOT NULL,
	PRIMARY KEY (ID_CLASS),
	FOREIGN KEY (ID_MAJOR) REFERENCES MAJOR (ID_MAJOR)
)

CREATE TABLE STUDENT
(
	ID_STUDENT VARCHAR (8) NOT NULL,
	NAME NVARCHAR (100) NOT NULL,
	SEX BIT NOT NULL,
	DATE_OF_BIRTH DATE NOT NULL,
	GMAIL VARCHAR (100) NOT NULL,
	ID_FACULTY VARCHAR (1) NOT NULL,
	ID_MAJOR VARCHAR (10) NOT NULL,
	ID_CLASS VARCHAR (8) NOT NULL,
	ID_PROGRAM VARCHAR (8) NOT NULL,
	ADMISSION_YEAR INT NOT NULL,
	PRIMARY KEY (ID_STUDENT),
	FOREIGN KEY (ID_FACULTY) REFERENCES FACULTY (ID_FACULTY),
	FOREIGN KEY (ID_MAJOR) REFERENCES MAJOR (ID_MAJOR),
	FOREIGN KEY (ID_CLASS) REFERENCES CLASS (ID_CLASS),
	FOREIGN KEY (ID_PROGRAM, ADMISSION_YEAR) REFERENCES PROGRAM (ID_PROGRAM, ADMISSION_YEAR)
)

CREATE TABLE SUBJECT
(
	ID_SUBJECT VARCHAR (8) NOT NULL,
	NAME NVARCHAR (400) NOT NULL,
	TOTAL_CREDIT INT NOT NULL,
	THEORY INT  NOT NULL,
	PRACTICE INT NOT NULL,
	EXAM INT NOT NULL,
	PRIMARY KEY (ID_SUBJECT)
)

CREATE TABLE PROGRAM_SUBJECT
(
	ID_SUBJECT VARCHAR (8) NOT NULL,
	ID_PROGRAM VARCHAR (8) NOT NULL,
	ADMISSION_YEAR INT NOT NULL,
	SEMESTER INT NOT NULL,
	PRIMARY KEY (ID_SUBJECT, ID_PROGRAM, ADMISSION_YEAR),
	FOREIGN KEY (ID_SUBJECT) REFERENCES SUBJECT (ID_SUBJECT),
	FOREIGN KEY (ID_PROGRAM, ADMISSION_YEAR) REFERENCES PROGRAM (ID_PROGRAM, ADMISSION_YEAR)
)

CREATE TABLE OPTIONAL_GROUP (
    ID_OPTIONAL_GROUP VARCHAR(20) NOT NULL,
    NAME NVARCHAR(200) NOT NULL,
    MIN_CREDIT INT NULL,
    MIN_SUBJECT INT NULL,
    PRIMARY KEY (ID_OPTIONAL_GROUP)
);


CREATE TABLE OPTIONAL_GROUP_PROGRAM(
    ID_OPTIONAL_GROUP VARCHAR(20) NOT NULL,
    ID_PROGRAM VARCHAR(8) NOT NULL,
    ADMISSION_YEAR INT NOT NULL,
    SEMESTER INT NOT NULL,
	CREDIT INT NULL,
	SUBJECT INT NULL,
	NOTE NVARCHAR (300) NULL
    PRIMARY KEY (ID_OPTIONAL_GROUP, ID_PROGRAM, ADMISSION_YEAR, SEMESTER),
    FOREIGN KEY (ID_OPTIONAL_GROUP) REFERENCES OPTIONAL_GROUP(ID_OPTIONAL_GROUP),
    FOREIGN KEY (ID_PROGRAM, ADMISSION_YEAR) REFERENCES PROGRAM(ID_PROGRAM, ADMISSION_YEAR)
);

CREATE TABLE OPTIONAL_GROUP_SUBJECT (
    ID_OPTIONAL_GROUP VARCHAR(20) NOT NULL,
    ID_SUBJECT VARCHAR(8) NOT NULL,

    PRIMARY KEY (ID_OPTIONAL_GROUP, ID_SUBJECT),
    FOREIGN KEY (ID_OPTIONAL_GROUP) REFERENCES OPTIONAL_GROUP(ID_OPTIONAL_GROUP),
    FOREIGN KEY (ID_SUBJECT) REFERENCES SUBJECT(ID_SUBJECT)
);

CREATE TABLE SUBJECT_SOFT_PREREQUISITE
(
	ID_PROGRAM VARCHAR (8) NOT NULL,
	ADMISSION_YEAR INT NOT NULL,
	ID_SUBJECT VARCHAR (8) NOT NULL,
	ID_SUBJECT_SOFT_PREREQUISITE VARCHAR (8) NOT NULL,
	PRIMARY KEY (ID_PROGRAM, ADMISSION_YEAR, ID_SUBJECT, ID_SUBJECT_SOFT_PREREQUISITE),
	FOREIGN KEY (ID_SUBJECT_SOFT_PREREQUISITE) REFERENCES SUBJECT (ID_SUBJECT),
	FOREIGN KEY (ID_SUBJECT) REFERENCES SUBJECT (ID_SUBJECT),
	FOREIGN KEY (ID_PROGRAM, ADMISSION_YEAR) REFERENCES PROGRAM (ID_PROGRAM, ADMISSION_YEAR)
)

CREATE TABLE SUBJECT_PARALLEL
(
	ID_PROGRAM VARCHAR (8) NOT NULL,
	ADMISSION_YEAR INT NOT NULL,
	ID_SUBJECT VARCHAR (8) NOT NULL,
	ID_SUBJECT_PARALLEL VARCHAR (8) NOT NULL,
	PRIMARY KEY (ID_PROGRAM, ADMISSION_YEAR, ID_SUBJECT, ID_SUBJECT_PARALLEL),
	FOREIGN KEY (ID_SUBJECT_PARALLEL) REFERENCES SUBJECT (ID_SUBJECT),
	FOREIGN KEY (ID_SUBJECT) REFERENCES SUBJECT (ID_SUBJECT),
	FOREIGN KEY (ID_PROGRAM, ADMISSION_YEAR) REFERENCES PROGRAM (ID_PROGRAM, ADMISSION_YEAR)
)

CREATE TABLE SUBJECT_STRICT_PREREQUISITE
(
	ID_PROGRAM VARCHAR (8) NOT NULL,
	ADMISSION_YEAR INT NOT NULL,
	ID_SUBJECT VARCHAR (8) NOT NULL,
	ID_SUBJECT_STRICT_PREREQUISITE VARCHAR (8) NOT NULL,
	PRIMARY KEY (ID_PROGRAM, ADMISSION_YEAR, ID_SUBJECT, ID_SUBJECT_STRICT_PREREQUISITE),
	FOREIGN KEY (ID_SUBJECT_STRICT_PREREQUISITE) REFERENCES SUBJECT (ID_SUBJECT),
	FOREIGN KEY (ID_SUBJECT) REFERENCES SUBJECT (ID_SUBJECT),
	FOREIGN KEY (ID_PROGRAM, ADMISSION_YEAR) REFERENCES PROGRAM (ID_PROGRAM, ADMISSION_YEAR)
)


CREATE TABLE PREREQUISITE_GROUP (
    	ID_GROUP VARCHAR(30) NOT NULL,
   	NAME NVARCHAR(200) NOT NULL,
    	PRIMARY KEY (ID_GROUP)
)

CREATE TABLE PREREQUISITE_GROUP_SUBJECTS (
    	ID_GROUP VARCHAR(8) NOT NULL,
    	ID_SUBJECT VARCHAR(8) NOT NULL,
    	PRIMARY KEY (ID_GROUP, ID_SUBJECT),
    	FOREIGN KEY (ID_GROUP) REFERENCES PREREQUISITE_GROUP(ID_GROUP),
    	FOREIGN KEY (ID_SUBJECT) REFERENCES SUBJECT(ID_SUBJECT)
)

CREATE TABLE GROUP_SUBJECT_STRICT_PREREQUISITE
(
	ID_PROGRAM VARCHAR (8) NOT NULL,
	ADMISSION_YEAR INT NOT NULL,
	ID_SUBJECT VARCHAR (8) NOT NULL,
	ID_GROUP VARCHAR(30) NOT NULL,
	PRIMARY KEY (ID_PROGRAM, ADMISSION_YEAR, ID_SUBJECT, ID_GROUP),
	FOREIGN KEY (ID_GROUP) REFERENCES PREREQUISITE_GROUP(ID_GROUP)
	FOREIGN KEY (ID_SUBJECT) REFERENCES SUBJECT (ID_SUBJECT),
	FOREIGN KEY (ID_PROGRAM, ADMISSION_YEAR) REFERENCES PROGRAM (ID_PROGRAM, ADMISSION_YEAR)
)

CREATE TABLE SCHEDULE 
(
	ID_SCHEDULE VARCHAR (8) NOT NULL,
	ID_SUBJECT VARCHAR (8) NOT NULL,
	YEAR VARCHAR (20) NOT NULL,
	SEMESTER INT NOT NULL,
	DAY_NAME NVARCHAR (50) NOT NULL,
	SESSION INT NOT NULL,
	WEEK VARCHAR (50) NOT NULL,
	START_PERIOD INT NOT NULL,
	PERIODS INT NOT NULL,
	TEACHER NVARCHAR (100) NULL,
	ROOM VARCHAR (10) NULL,
	NOTE NVARCHAR (300) NULL,
	PRIMARY KEY (ID_SCHEDULE, ID_SUBJECT, YEAR, SEMESTER),
	FOREIGN KEY (ID_SUBJECT) REFERENCES SUBJECT (ID_SUBJECT) 
)

CREATE TABLE THEORY_SCHEDULE
(
	ID_SCHEDULE VARCHAR (8) NOT NULL,
	ID_SUBJECT VARCHAR (8) NOT NULL,
	YEAR VARCHAR (20) NOT NULL,
	SEMESTER INT NOT NULL,
	DAY DATE NOT NULL,
	DAY_NAME NVARCHAR (50) NOT NULL,
	ROOM VARCHAR (10) NOT NULL,
	STATUS NVARCHAR (100) NOT NULL,
	START_PERIOD INT NOT NULL,
	PERIODS INT NOT NULL,
	PRIMARY KEY (ID_SCHEDULE, ID_SUBJECT, YEAR, SEMESTER, DAY),
	FOREIGN KEY (ID_SCHEDULE, ID_SUBJECT, YEAR, SEMESTER) REFERENCES SCHEDULE (ID_SCHEDULE, ID_SUBJECT, YEAR, SEMESTER)
)

CREATE TABLE GROUP_PRACTICE
(
	ID_SCHEDULE VARCHAR (8) NOT NULL,
	ID_SUBJECT VARCHAR (8) NOT NULL,
	YEAR VARCHAR (20) NOT NULL,
	SEMESTER INT NOT NULL,
	ID_GROUP VARCHAR (8) NOT NULL,
	DAY_NAME NVARCHAR (50) NOT NULL,
	SESSION INT NOT NULL,
	WEEK VARCHAR (50) NOT NULL,
	START_PERIOD INT NOT NULL,
	PERIODS INT NOT NULL,
	TEACHER NVARCHAR (100) NULL,
	ROOM VARCHAR (10) NULL,
	NOTE NVARCHAR (300) NULL,
	PRIMARY KEY (ID_SCHEDULE, ID_SUBJECT, YEAR, SEMESTER, ID_GROUP),
	FOREIGN KEY (ID_SCHEDULE, ID_SUBJECT, YEAR, SEMESTER) REFERENCES SCHEDULE (ID_SCHEDULE, ID_SUBJECT, YEAR, SEMESTER),
)

CREATE TABLE PRACTICE_SCHEDULE
(
	ID_SCHEDULE VARCHAR (8) NOT NULL,
	ID_SUBJECT VARCHAR (8) NOT NULL,
	YEAR VARCHAR (20) NOT NULL,
	SEMESTER INT NOT NULL,
	ID_GROUP VARCHAR (8) NOT NULL,
	DAY DATE NOT NULL,
	DAY_NAME NVARCHAR (50) NOT NULL,
	ROOM VARCHAR (10) NOT NULL,
	STATUS NVARCHAR (100) NOT NULL,
	START_PERIOD INT NOT NULL,
	PERIODS INT NOT NULL,
	PRIMARY KEY (ID_SCHEDULE, ID_SUBJECT, YEAR, SEMESTER, ID_GROUP, DAY),
	FOREIGN KEY (ID_SCHEDULE, ID_SUBJECT, YEAR, SEMESTER, ID_GROUP) REFERENCES GROUP_PRACTICE (ID_SCHEDULE, ID_SUBJECT, YEAR, SEMESTER, ID_GROUP)
)

CREATE TABLE APPLY_SUBJECT 
(
	ID_STUDENT VARCHAR (8) NOT NULL,
	ID_SCHEDULE VARCHAR (8) NOT NULL,
	ID_SUBJECT VARCHAR (8) NOT NULL,
	YEAR VARCHAR (20) NOT NULL,
	SEMESTER INT NOT NULL,
	ID_GROUP VARCHAR (8) NOT NULL,
	DAY_APPLY DATETIME NOT NULL,
	PRIMARY KEY (ID_STUDENT, ID_SCHEDULE, ID_SUBJECT, YEAR, SEMESTER),
	FOREIGN KEY (ID_STUDENT) REFERENCES STUDENT (ID_STUDENT),
	FOREIGN KEY (ID_SCHEDULE, ID_SUBJECT, YEAR, SEMESTER, ID_GROUP) REFERENCES GROUP_PRACTICE (ID_SCHEDULE, ID_SUBJECT, YEAR, SEMESTER, ID_GROUP),
	FOREIGN KEY (ID_SCHEDULE, ID_SUBJECT, YEAR, SEMESTER) REFERENCES SCHEDULE (ID_SCHEDULE, ID_SUBJECT, YEAR, SEMESTER)
)

CREATE TABLE EXAM_SUBJECT
(
	ID_SCHEDULE VARCHAR (8) NOT NULL,
	ID_SUBJECT VARCHAR (8) NOT NULL,
	YEAR VARCHAR (20) NOT NULL,
	SEMESTER INT NOT NULL,
	DAY DATE NOT NULL,
	START TIME(0) NOT NULL,
	DURATION INT NOT NULL,
	ROOM VARCHAR (10) NOT NULL,
	SUB_GROUP VARCHAR (10) NOT NULL,
	TYPE NVARCHAR (20) NOT NULL,
	DAY_NAME NVARCHAR (20) NOT NULL,
	PRIMARY KEY (ID_SCHEDULE, ID_SUBJECT, YEAR, SEMESTER, DAY, START),
	FOREIGN KEY (ID_SCHEDULE, ID_SUBJECT, YEAR, SEMESTER) REFERENCES SCHEDULE (ID_SCHEDULE, ID_SUBJECT, YEAR, SEMESTER)
)

CREATE TABLE SUBJECT_RESULT
(
	ID_STUDENT VARCHAR (8) NOT NULL,
	ID_SUBJECT VARCHAR (8) NOT NULL,
	ATTEMPT INT NOT NULL,
	TEST_1 FLOAT NULL,
	TEST_2 FLOAT NULL,
	MIDTERM_TEST FLOAT NULL,
	FINAL_TEST FLOAT NULL,
	STATUS NVARCHAR (10) NULL,
	PRIMARY KEY (ID_STUDENT, ID_SUBJECT, ATTEMPT),
	FOREIGN KEY (ID_STUDENT) REFERENCES STUDENT (ID_STUDENT),
	FOREIGN KEY (ID_SUBJECT) REFERENCES SUBJECT (ID_SUBJECT)
)

CREATE TABLE TRAINING_POINT
(
	ID_STUDENT VARCHAR (8) NOT NULL,
	SEMESTER INT NOT NULL,
	YEAR VARCHAR (20) NOT NULL,
	SCORE INT NULL,
	PRIMARY KEY (ID_STUDENT, SEMESTER, YEAR),
	FOREIGN KEY (ID_STUDENT) REFERENCES STUDENT (ID_STUDENT)
)

CREATE TABLE CRITERIA_TRAINING_POINT
(
	ID_CRITERIA VARCHAR (10) NOT NULL,
	NAME NVARCHAR (300) NOT NULL,
	SCORE INT NULL
	PRIMARY KEY (ID_CRITERIA)
)

CREATE TABLE EVENT_TRAINING_POINT
(
	ID_EVENT VARCHAR (10) NOT NULL,
	ID_STUDENT VARCHAR (8) NOT NULL,
	SEMESTER INT NOT NULL,
	YEAR VARCHAR (20) NOT NULL,
	ID_CRITERIA VARCHAR (10) NOT NULL,
	NAME NVARCHAR (300) NOT NULL,
	SCORE INT NOT NULL,
	PRIMARY KEY (ID_EVENT, ID_STUDENT, SEMESTER, YEAR, ID_CRITERIA),
	FOREIGN KEY (ID_STUDENT, SEMESTER, YEAR) REFERENCES TRAINING_POINT (ID_STUDENT, SEMESTER, YEAR),
	FOREIGN KEY (ID_CRITERIA) REFERENCES CRITERIA_TRAINING_POINT (ID_CRITERIA)

)